&НаСервере
// Создает запись в регистре сведений наряд-заказы
//
// Параметры:
//	<ПараметрыНЗ>	- Структура:
//  <ДатаНЗ>  		- <Дата.Дата и время> - дата наряд-заказа
//  <НомерНЗ>  		- <Строка (15)> - номер наряд-заказа
//  <ДатаЗаявки>  	- <Дата.Дата и время> - дата заявки
//  <НомерЗаявки>	- <Строка (15)> - Номер заявки
//
Процедура СоздатьНЗСервер(ПараметрыНЗ)
	рсвНЗ = РегистрыСведений.НЗ.СоздатьМенеджерЗаписи();
	рсвНЗ.Заполнить(ПараметрыНЗ);
КонецПроцедуры // СоздатьНЗСервер()

&НаКлиенте
Процедура ВвестиСобытие(Команда)
	ПарЗаполнения = новый структура;
	ПарЗаполнения.Вставить("ДатаЗаявки" , Запись.Дата);
	ПарЗаполнения.Вставить("Контрагент" , Запись.Контрагент);
	ПарЗаполнения.Вставить("НомерЗаявки", Запись.Номер);
	ОткрытьФорму("РегистрСведений.События.ФормаЗаписи", ПарЗаполнения);
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	ТекстЗаявки	= Вспомогательный.ПолучитьШапкуHTMLФайла() + 
	 Вспомогательный.ПолучитьСтрокуЗаявкиHTML(Запись.Заявка) + 
	 Вспомогательный.ПолучитьПодвалHTMLФайла();
	ТекстПроезд	= Вспомогательный.ПолучитьШапкуHTMLФайла() + 
	 Вспомогательный.ПолучитьСтрокуHTMLКонтактнойИнформации(Запись) + 
	 Вспомогательный.ПолучитьПодвалHTMLФайла();
КонецПроцедуры

&НаКлиенте
Процедура КонтактнаяИнформацияПриНажатии(Элемент, ДанныеСобытия, СтандартнаяОбработка)
	СтандартнаяОбработка = ложь;
	стрСсылка = ДанныеСобытия.href;
	#Если МобильноеПриложениеКлиент тогда
		Вспомогательный.ОбработатьНажатиеНаСсылку(стрСсылка);
	#иначе
		Сообщить (""+стрСсылка);
	#КонецЕсли
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	эл = РеквизитФормыВЗначение("Запись");
	НЗ.Параметры.УстановитьЗначениеПараметра("ДатаЗаявки"	, эл.Дата);
	НЗ.Параметры.УстановитьЗначениеПараметра("НомерЗаявки"	, эл.Номер);
КонецПроцедуры

&НаКлиенте
Процедура СоздатьНЗ(Команда)
	тДата = ТекущаяДата();
	стрПараметры = Новый Структура;
	стрПараметры.Вставить("ДатаНЗ"		, тДата);
	стрПараметры.Вставить("НомерНЗ"		, "новый"+Формат (тДата,"ДФ=hhmmss"));
	стрПараметры.Вставить("ДатаЗаявки"	, Запись.Дата);
	стрПараметры.Вставить("НомерЗаявки"	, Запись.Номер);
	СоздатьНЗСервер(стрПараметры);
	ОткрытьФорму("РегистрСведений.НЗ.ФормаЗаписи"		, стрПараметры);
КонецПроцедуры

