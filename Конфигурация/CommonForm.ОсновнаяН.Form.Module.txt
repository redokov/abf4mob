

&НаСервере
функция ПолучитьДанныеЗаявки (Знач Состояние, Знач Дата, Знач Номер)
	рез = новый структура;
	Если ТипЗнч(Состояние) = Тип("ПеречислениеСсылка.СостояниеЗаявкиПринятые") тогда //получим данные принятой заявки
		рсв = РегистрыСведений.ЗаявкиПринятые.СоздатьМенеджерЗаписи();
		рсв.Состояние = Состояние;
		рсв.Дата = Дата;
		рсв.Номер = Номер;
		рсв.Прочитать();
		рез.Вставить("Заявка",рсв.Заявка);
		рез.Вставить("КонтактноеЛицо",рсв.КонтактноеЛицо);
		рез.Вставить("КонтактнаяИнформация",рсв.КонтактнаяИнформация);
		рез.Вставить("Метро",рсв.Метро);
		рез.Вставить("МаршрутПроезда",рсв.МаршрутПроезда);
		возврат рез;
	иначе //получим данные переданной заявки
		рсв = РегистрыСведений.ЗаявкиПереданные.СоздатьМенеджерЗаписи();
		рсв.Состояние = Состояние;
		рсв.Дата = Дата;
		рсв.Номер = Номер;
		рсв.Прочитать();
		рез.Вставить("Заявка",рсв.Заявка);
		рез.Вставить("КонтактноеЛицо",рсв.КонтактноеЛицо);
		рез.Вставить("КонтактнаяИнформация",рсв.КонтактнаяИнформация);
		рез.Вставить("Метро",рсв.Метро);
		рез.Вставить("МаршрутПроезда",рсв.МаршрутПроезда);
		возврат рез;
	КонецЕсли;
	
КонецФункции


&НаКлиенте
Процедура СписокЗаявокПриАктивизацииПоля(Элемент)
	// Вставить содержимое обработчика.
	ТекДанные = Элемент.ТекущиеДанные;
	Если ТекДанные <> Неопределено тогда
		Состояние = ТекДанные.Состояние;
		Дата = ТекДанные.Дата;
		Номер = ТекДанные.Номер;
		рез = ПолучитьДанныеЗаявки(Состояние,Дата,Номер);
		Если рез = ложь тогда
			Сообщить ("Неверно определена заявка");
			возврат;
		КонецЕсли;
		ЭтаФорма.Заявка = рез.Заявка;
		ЭтаФорма.КонтактнаяИнформация = рез.КонтактнаяИнформация;
		ЭтаФорма.КонтактноеЛицо = рез.КонтактноеЛицо;
		//ЭтаФорма.Метро = рез.Метро;
		//ЭтаФорма.МаршрутПроезда = рез.МаршрутПроезда;
	иначе
		ЭтаФорма.Заявка = "";
		ЭтаФорма.КонтактнаяИнформация = "";
		ЭтаФорма.КонтактноеЛицо = "";
	КонецЕсли;

КонецПроцедуры


&НаКлиенте
Процедура ОбработкаОповещения(ИмяСобытия, Параметр, Источник)
	//Вставить содержимое обработчика
	Если ИмяСобытия="ЗагруженыЗаявкиПереданные" тогда
		Элементы.ЗаявкиПереданные.Обновить();
		Элементы.ЗаявкиПринятые.Обновить();
	КонецЕсли;
КонецПроцедуры


&НаКлиенте
Процедура ЗаявкиПринятыеОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)
	// Вставить содержимое обработчика.
	Сообщить ("тест");
	СтандартнаяОбработка = ложь;
КонецПроцедуры

